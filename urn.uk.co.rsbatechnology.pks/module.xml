<module version="2.0">
	<meta>
		<identity>
			<uri>urn:uk:co:rsbatechnology:pks</uri>
			<version>0.0.1</version>
		</identity>
		<info>
			<name>Position Keeping Module</name>
			<description>Positions and position deltas
			</description>
		</info>
	</meta>
	<system>
		<dynamic />
	</system>
	<rootspace name="PKS Position Cache Rootspace" uri="urn:uk:co:rsbatechnology:pks:position"
		public="true">
		<mapper>
			<config>
				<import>res:/uk/co/rsbatechnology/pks/positionCacheMapperConfig.xml</import>
				<import>res:/uk/co/rsbatechnology/pks/positionDeltaCacheMapperConfig.xml</import>
				<endpoint>
					<description>Posts a position delta to the position cache
					</description>
					<verbs>SOURCE</verbs>
					<grammar>
						<active>
							<identifier>active:positionPosting</identifier>
							<argument name="operand" desc="Identity of Position Delta resource to be posted" />
						</active>
					</grammar>
					<request>
						<identifier>active:groovy</identifier>
						<argument name="operator">res:/uk/co/rsbatechnology/pks/positionPosting.groovy</argument>
						<argument name="operand">arg:operand</argument>
					</request>
				</endpoint>				
			</config>
			<space>
				<fileset>
					<regex>res:/uk/co/rsbatechnology/pks/.*</regex>
				</fileset>
				<literal type="hds" uri="res:/dummy">
					<position>
						<amounts>
							<amount>
								<type>SETTLEMENT</type>
							 	<symbol>EUR</symbol>
							 	<value>1000</value>
							</amount>
							<amount>
								<type>BASE</type>
							 	<symbol>USD</symbol>
							 	<value>1300</value>
							</amount>
						</amounts>
					</position>
				</literal>
				<!-- Use PDS as our persistence service -->
				<import>
					<uri>urn:org:netkernel:mod:pds</uri>
				</import>
				<import>
					<uri>urn:org:netkernel:mod:pds:rdbms:local</uri>
				</import>
				<!-- Literal PDS configuration -->
				<literal type="xml" uri="res:/etc/pdsConfig.xml">
					<config>
						<zone>global:pks</zone>
					</config>
				</literal>
				<!-- Enables active:groovy to be resolvable -->
				<import><uri>urn:org:netkernel:lang:groovy</uri></import>
				<!--  XRL used in active:positions service -->
				<import><uri>urn:org:netkernel:lang:xrl</uri></import>				
				<!--  XSLT2 used in active:allPositions service -->
				<import><uri>urn:org:netkernel:xml:saxon</uri></import>				
				<import><uri>urn:org:netkernel:lang:dpml</uri></import>
			</space>
		</mapper>
	</rootspace>
		<rootspace uri="urn:uk:co:rsbatechnology:pks:diary">
		<!--Declare the documentation for publication into the doc system -->
		<fileset>
			<regex>res:/etc/system/(Books|Docs).xml</regex>
		</fileset>
		<fileset>
			<regex>res:/doc/.*</regex>
		</fileset>
	</rootspace>
</module>